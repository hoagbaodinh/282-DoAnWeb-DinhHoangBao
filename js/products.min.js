const products=[{id:"1",title:"Her The KRAFT",cate:"her",image:"./img/pd-1.png",imageHover:"./img/pd-hover-1.png",price:38e4},{id:"2",title:"Him The KRAFT",cate:"him",image:"./img/pd-2.png",imageHover:"./img/pd-hover-2.png",price:32e4},{id:"3",title:"Santa the KRAFT",cate:"other",image:"./img/pd-3.png",imageHover:"./img/pd-hover-3.png",price:32e4},{id:"4",title:"Say cheese the KRAFT",cate:"other",image:"./img/pd-4.png",imageHover:"./img/pd-hover-4.png",price:145e3},{id:"5",title:"Apology The KRAFT",cate:"other",image:"./img/pd-5.png",imageHover:"./img/pd-hover-5.png",price:125e3},{id:"6",title:"Daily Stuff The KRAFT",cate:"other",image:"./img/pd-6.png",imageHover:"./img/pd-hover-6.png",price:185e3},{id:"7",title:" Him The KRAFT ( Black Vibe)",cate:"him",image:"./img/pd-7.png",imageHover:"./img/pd-hover-7.png",price:235e3},{id:"8",title:"Valentine The KRAFT",cate:"her",image:"./img/pd-8.png",imageHover:"./img/pd-hover-8.png",price:18e4}],cartBtn=document.querySelector(".nav-shop"),closeCartBtn=document.querySelector(".cart__close"),clearCartBtn=document.querySelector(".cart__amount-trash"),cartItemNumber=document.querySelector(".cart__amount-number"),cartDOM=document.querySelector(".cart"),cartItems=document.querySelector(".cart-items"),cartTotal=document.querySelector(".cart-total"),cartContent=document.querySelector(".cart__container"),productsDOM=document.querySelector(".pd-content"),cateDOM=document.querySelector(".cate-sidebar-item-list");let filteredProducts=[...products],cart=[],buttonsDOM=[];class Products{async getProduct(){try{return filteredProducts}catch(t){console.log(t)}}}class UI{displayProducts(t){if(productsDOM){let e="";t.forEach(t=>{t.price=t.price.toLocaleString("en-US"),e+=`\n        <div class="col-lg-3 col-sm-6 col-12">\n        <div class="pd-item">\n          <a href="product-ring.html">\n            <img\n              src=${t.image}\n              alt="product"\n              class="pd-item-img"\n            />\n          </a>\n          <a href="product-ring.html">\n            <h4 class="pd-title">\n              ${t.title}\n            </h4>\n          </a>\n  \n          <p class="pd-price">${t.price}đ</p>\n          <div class="pd-hover">\n            <a href="product-ring.html">\n              <img\n                src= ${t.imageHover}\n                alt="pd hover"\n                class="pd-hover-img"\n                s\n              />\n            </a>\n  \n            <ul class="pd-hover-btns">\n              <li>\n                <button class="pd-hover-btn bag-btn" data-id=${t.id}>\n\n                </button>\n              </li>\n              <li>\n                <button href="#" class="pd-hover-btn">\n                  <i class="bx bx-heart"></i>\n                </button>\n              </li>\n              <li>\n                <button href="#" class="pd-hover-btn">\n                  <i class="fa-regular fa-eye"></i>\n                </button>\n              </li>\n              <li>\n                <button href="#" class="pd-hover-btn">\n                  <i class="bx bx-shuffle"></i>\n                </button>\n              </li>\n            </ul>\n            <ul class="pd-item-rating">\n              <li><i class="fa-solid fa-star star"></i></li>\n              <li><i class="fa-solid fa-star star"></i></li>\n              <li><i class="fa-solid fa-star star"></i></li>\n              <li><i class="fa-solid fa-star star"></i></li>\n              <li><i class="fa-solid fa-star"></i></li>\n            </ul>\n          </div>\n        </div>\n      </div>\n              `}),productsDOM.innerHTML=e}}displaySidebarProduct(t){if(document.querySelector(".sidebar-pd-list")){const e=document.querySelector(".sidebar-pd-list");let a="";t.forEach(t=>{t.price=t.price.toLocaleString("en-US"),a+=`\n        <div class="swiper-slide sidebar-pd-item">\n          <img src=${t.image} alt="" />\n          <div>\n            <h4>${t.title}</h4>\n            <p>$${t.price}</p>\n          </div>\n      </div>\n        `}),e.innerHTML=a}}dpListViewPd(t){if(document.querySelector(".list-view-pd-content")){const e=document.querySelector(".list-view-pd-content");let a="";t.forEach(t=>{t.price=t.price.toLocaleString("en-US"),a+=`\n        <div class="col-12">\n        <div class="list-view-pd-item row">\n          <div class="col-md-4 position-relative">\n            <a href="product-ring.html" class="d-block">\n              <img\n                src=${t.image}\n                alt=""\n                class="pd-item-img"\n              />\n            </a>\n            <div class="pd-hover">\n              <a href="product-ring.html">\n                <img\n                  src=${t.imageHover}\n                  alt="pd hover"\n                  class="pd-hover-img"\n                />\n              </a>\n              <ul class="pd-hover-btns">\n                <li>\n                  <button class="pd-hover-btn bag-btn" data-id=${t.id}>\n                  </button>\n                </li>\n                <li>\n                  <a href="#" class="pd-hover-btn">\n                    <i class="bx bx-heart"></i>\n                  </a>\n                </li>\n                <li>\n                  <a href="#" class="pd-hover-btn">\n                    <i class="fa-regular fa-eye"></i>\n                  </a>\n                </li>\n                <li>\n                  <a href="#" class="pd-hover-btn">\n                    <i class="bx bx-shuffle"></i>\n                  </a>\n                </li>\n              </ul>\n            </div>\n          </div>\n          <div class="col-md-8">\n            <div class="list-view-pd-desc">\n              <a href="product-ring.html">\n                <h2 class="pd-title">\n                  ${t.title}\n                </h2>\n              </a>\n              <ul class="pd-item-rating">\n                <li><i class="fa-solid fa-star star"></i></li>\n                <li><i class="fa-solid fa-star star"></i></li>\n                <li><i class="fa-solid fa-star star"></i></li>\n                <li><i class="fa-solid fa-star star"></i></li>\n                <li><i class="fa-solid fa-star"></i></li>\n              </ul>\n              <p class="pd-price">$${t.price}</p>\n              <p class="pd-text">\n                All the Lorem Ipsum generators on the Internet\n                tend to repeat predefined chunks as necessary,\n                making this the first true generator on the\n                Internet.\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n        `}),e.innerHTML=a}}displayCateButton(){const t=["all",...new Set(products.map(t=>t.cate))];cateDOM&&(cateDOM.innerHTML=t.map(t=>{let e=0;for(let a=0;a<products.length;a++)products[a].cate===t&&e++,"all"===t&&(e=products.length);return`\n        <li>\n          <button class="cate-sidebar-item-link" data-id="${t}">\n            ${t} (${e})\n          </button>\n        </li>\n        `}).join(""),cateDOM.addEventListener("click",t=>{const e=t.target;e.classList.contains("cate-sidebar-item-link")&&(filteredProducts="all"===e.dataset.id?[...products]:products.filter(t=>t.cate===e.dataset.id),displayProducts(filteredProducts),dpListViewPd(filteredProducts))}))}getBagButtons(){const t=[...document.querySelectorAll(".bag-btn")];buttonsDOM=t,t.forEach(t=>{let e=t.dataset.id;cart.find(t=>t.id===e)&&(t.disabled=!0),t.addEventListener("click",t=>{t.target.disabled=!0;let a={...Storage.getProduct(e),amount:1};cart=[...cart,a],Storage.saveCart(cart),this.setCartValues(cart),this.addCartItem(a),this.showCart()})})}setCartValues(t){if(cartTotal&&cartItems){let e=0,a=0;t.map(t=>{let i=1e3*parseInt(t.price,10);e+=i*t.amount,a+=t.amount}),cartTotal.innerText=e.toLocaleString("en-US"),cartItems.innerText=a}}addCartItem(t){const e=document.createElement("div");e.classList.add("cart__card"),t.price=t.price.toLocaleString("en-US"),e.innerHTML=`\n    <div class="cart__box">\n    <img src=${t.image} alt="" class="cart__img" />\n    </div>\n\n    <div class="cart__details">\n    <h3 class="cart__title">${t.title}</h3>\n    <span class="cart__price">${t.price}đ </span>\n\n    <div class="cart__amount">\n      <div class="cart__amount-content">\n        <i class="bx bx-minus cart__amount-box cart-minus " data-id=${t.id} ></i>\n        <span class="cart__amount-number">${t.amount}</span>\n        <i class="bx bx-plus cart__amount-box cart-plus" data-id=${t.id} ></i>\n      </div>\n\n      <i class="bx bx-trash-alt cart__amount-trash" data-id=${t.id}></i>\n    </div>\n  </div>\n    `,cartContent.appendChild(e)}showCart(){cartDOM.classList.add("show-cart")}closeCart(){cartDOM.classList.remove("show-cart")}hideCart(){cartDOM.classList.remove("show-cart")}setupAPP(){cart=Storage.getCart(),this.setCartValues(cart),this.populate(cart),cartBtn.addEventListener("click",this.showCart),closeCartBtn.addEventListener("click",this.hideCart)}populate(t){t.forEach(t=>{this.addCartItem(t)})}cartLogic(){cartContent.addEventListener("click",t=>{if(console.log(t.target),t.target.classList.contains("cart__amount-trash")){let e=t.target,a=e.dataset.id;cartContent.removeChild(e.parentElement.parentElement.parentElement),this.removeItem(a)}else if(t.target.classList.contains("cart-plus")){let e=t.target,a=e.dataset.id,i=cart.find(t=>t.id===a);i.amount+=1,Storage.saveCart(cart),this.setCartValues(cart),e.previousElementSibling.innerText=i.amount}else if(t.target.classList.contains("cart-minus")){let e=t.target,a=e.dataset.id,i=cart.find(t=>t.id===a);i.amount-=1,i.amount>0?(Storage.saveCart(cart),this.setCartValues(cart),e.nextElementSibling.innerText=i.amount):(cartContent.removeChild(e.parentElement.parentElement.parentElement.parentElement),this.removeItem(a))}})}clearCart(){for(cart.map(t=>t.id).forEach(t=>this.removeItem(t));cartContent.children.length>0;)cartContent.removeChild(cartContent.children[0]);this.hideCart()}removeItem(t){cart=cart.filter(e=>e.id!==t),this.setCartValues(cart),Storage.saveCart(cart);this.getSingleButton(t).disabled=!1}getSingleButton(t){return buttonsDOM.find(e=>e.dataset.id===t)}}class Storage{static saveProduct(t){localStorage.setItem("products",JSON.stringify(t))}static getProduct(t){return JSON.parse(localStorage.getItem("products")).find(e=>e.id===t)}static saveCart(t){localStorage.setItem("cart",JSON.stringify(t))}static getCart(){return localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")):[]}}document.addEventListener("DOMContentLoaded",()=>{const t=new UI,e=new Products;t.setupAPP(),e.getProduct().then(e=>{t.displaySidebarProduct(e),t.displayProducts(e),t.dpListViewPd(e),t.displayCateButton(),Storage.saveProduct(e)}).then(()=>{t.getBagButtons(),t.cartLogic()}),cateDOM&&cateDOM.addEventListener("click",e=>{const a=e.target;a.classList.contains("cate-sidebar-item-link")&&(filteredProducts="all"===a.dataset.id?[...products]:products.filter(t=>t.cate===a.dataset.id),t.displayProducts(filteredProducts),t.dpListViewPd(filteredProducts))})});